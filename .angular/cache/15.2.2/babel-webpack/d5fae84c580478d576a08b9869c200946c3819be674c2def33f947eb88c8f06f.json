{"ast":null,"code":"import { combineLatest, Subject } from 'rxjs';\nimport { map, startWith, switchMap, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./country.service\";\nimport * as i2 from \"./dropdown/dropdown.component\";\nexport class Exercise5Component {\n  constructor(service) {\n    this.service = service;\n    this.countryControl = new Subject();\n    this.stateControl = new Subject();\n    this.countries$ = combineLatest([this.countryControl.pipe(startWith('')), this.service.getCountries()]).pipe(map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1)));\n    this.states$ = this.stateControl.pipe(startWith(''), switchMap(userInput => this.service.getStatesFor(this.currentCountry?.id).pipe(tap(v => console.log(\"combineLatest(states) emitted:\", v)), map(states => states.filter(state => state.description.toLowerCase().includes(userInput.toLowerCase()))))));\n  }\n  countryInputChange(data) {\n    console.log('in parent for country', data);\n    this.countryControl.next(data.input);\n    this.currentCountry = data.country;\n    this.stateControl.next('');\n  }\n  stateInputChange(data) {\n    console.log('in parent for state', data);\n    if (data && data?.country) {\n      this.stateControl.next(data?.stateInput);\n    }\n  }\n}\nExercise5Component.ɵfac = function Exercise5Component_Factory(t) {\n  return new (t || Exercise5Component)(i0.ɵɵdirectiveInject(i1.CountryService));\n};\nExercise5Component.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: Exercise5Component,\n  selectors: [[\"app-exercise5\"]],\n  decls: 9,\n  vars: 5,\n  consts: [[\"src\", \"assets/exercise5.gif\"], [3, \"placeholderText\", \"dropdownData$\", \"countryEmitter\"], [3, \"placeholderText\", \"dropdownData$\", \"currentCountry\", \"stateEmitter\"]],\n  template: function Exercise5Component_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"img\", 0);\n      i0.ɵɵelementStart(1, \"div\")(2, \"h3\");\n      i0.ɵɵtext(3, \"Country Dropdown\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"app-dropdown\", 1);\n      i0.ɵɵlistener(\"countryEmitter\", function Exercise5Component_Template_app_dropdown_countryEmitter_4_listener($event) {\n        return ctx.countryInputChange($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\")(6, \"h3\");\n      i0.ɵɵtext(7, \"States Dropdown\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"app-dropdown\", 2);\n      i0.ɵɵlistener(\"stateEmitter\", function Exercise5Component_Template_app_dropdown_stateEmitter_8_listener($event) {\n        return ctx.stateInputChange($event);\n      });\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"placeholderText\", \"Country\")(\"dropdownData$\", ctx.countries$);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"placeholderText\", \"State\")(\"dropdownData$\", ctx.states$)(\"currentCountry\", ctx.currentCountry);\n    }\n  },\n  dependencies: [i2.DropdownComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AACA,SAAQA,aAAa,EAAkBC,OAAO,QAAO,MAAM;AAI3D,SAAQC,GAAG,EAAEC,SAAS,EAAEC,SAAS,EAAEC,GAAG,QAAO,gBAAgB;;;;AAO7D,OAAM,MAAOC,kBAAkB;EAS7BC,YAAoBC,OAAuB;IAAvB,YAAO,GAAPA,OAAO;IAH3B,mBAAc,GAAG,IAAIP,OAAO,EAAU;IACtC,iBAAY,GAAG,IAAIA,OAAO,EAAU;IAGlC,IAAI,CAACQ,UAAU,GAAGT,aAAa,CAAC,CAC9B,IAAI,CAACU,cAAc,CAACC,IAAI,CAACR,SAAS,CAAC,EAAE,CAAC,CAAC,EACvC,IAAI,CAACK,OAAO,CAACI,YAAY,EAAE,CAC5B,CAAC,CACDD,IAAI,CACHT,GAAG,CAAC,CAAC,CAACW,SAAS,EAAEC,SAAS,CAAC,KAAKA,SAAS,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,OAAO,CAACN,SAAS,CAACK,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC5H;IAED,IAAI,CAACE,OAAO,GAAG,IAAI,CAACC,YAAY,CAACV,IAAI,CACnCR,SAAS,CAAC,EAAE,CAAC,EACbC,SAAS,CAACS,SAAS,IACjB,IAAI,CAACL,OAAO,CAACc,YAAY,CAAC,IAAI,CAACC,cAAc,EAAEC,EAAE,CAAC,CAACb,IAAI,CACrDN,GAAG,CAACoB,CAAC,IAAIC,OAAO,CAACC,GAAG,CAAC,gCAAgC,EAAEF,CAAC,CAAC,CAAC,EAC1DvB,GAAG,CAAC0B,MAAM,IAAIA,MAAM,CAACb,MAAM,CAACc,KAAK,IAAIA,KAAK,CAACZ,WAAW,CAACC,WAAW,EAAE,CAACY,QAAQ,CAACjB,SAAS,CAACK,WAAW,EAAE,CAAC,CAAC,CAAC,CACzG,CACF,CACF;EACH;EAEAa,kBAAkB,CAACC,IAAQ;IACzBN,OAAO,CAACC,GAAG,CAAC,uBAAuB,EAAEK,IAAI,CAAC;IAC1C,IAAI,CAACtB,cAAc,CAACuB,IAAI,CAACD,IAAI,CAACE,KAAK,CAAC;IACpC,IAAI,CAACX,cAAc,GAAGS,IAAI,CAACG,OAAO;IAClC,IAAI,CAACd,YAAY,CAACY,IAAI,CAAC,EAAE,CAAC;EAC5B;EAEAG,gBAAgB,CAACJ,IAAQ;IACvBN,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEK,IAAI,CAAC;IACxC,IAAGA,IAAI,IAAIA,IAAI,EAAEG,OAAO,EAAC;MACvB,IAAI,CAACd,YAAY,CAACY,IAAI,CAACD,IAAI,EAAEK,UAAU,CAAC;;EAE5C;;AAzCW/B,kBAAkB;mBAAlBA,kBAAkB;AAAA;AAAlBA,kBAAkB;QAAlBA,kBAAkB;EAAAgC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCZ/BC,yBAAkC;MAElCA,2BAAK;MACCA,gCAAgB;MAAAA,iBAAK;MACzBA,uCAII;MADFA;QAAA,OAAkBC,8BAA0B;MAAA,EAAC;MAH/CD,iBAII;MAENA,2BAAK;MACCA,+BAAe;MAAAA,iBAAK;MACxBA,uCAKE;MADAA;QAAA,OAAgBC,4BAAwB;MAAA,EAAC;MAJ3CD,iBAKE;;;MAZAA,eAA6B;MAA7BA,2CAA6B;MAQ7BA,eAA2B;MAA3BA,yCAA2B","names":["combineLatest","Subject","map","startWith","switchMap","tap","Exercise5Component","constructor","service","countries$","countryControl","pipe","getCountries","userInput","countries","filter","c","description","toLowerCase","indexOf","states$","stateControl","getStatesFor","currentCountry","id","v","console","log","states","state","includes","countryInputChange","data","next","input","country","stateInputChange","stateInput","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["/workspaces/ng-advanced-workshop/src/app/exercise5/exercise5.component.ts","/workspaces/ng-advanced-workshop/src/app/exercise5/exercise5.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport {combineLatest, Observable, of, Subject} from 'rxjs';\nimport {Country, State, CountryWithInput} from './types';\nimport {FormControl} from '@angular/forms';\nimport {CountryService} from './country.service';\nimport {map, startWith, switchMap, tap} from 'rxjs/operators';\n\n@Component({\n  selector: 'app-exercise5',\n  templateUrl: './exercise5.component.html',\n  styleUrls: ['./exercise5.component.css']\n})\nexport class Exercise5Component {\n\n  countries$: Observable<Country[]>;\n  currentCountry : Country;\n  states$: Observable<State[]>;\n  \n  countryControl = new Subject<string>();\n  stateControl = new Subject<string>();\n\n  constructor(private service: CountryService) {\n    this.countries$ = combineLatest([\n      this.countryControl.pipe(startWith('')),\n      this.service.getCountries()\n    ])\n    .pipe(\n      map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1))\n    );\n\n    this.states$ = this.stateControl.pipe(\n      startWith(''),\n      switchMap(userInput => \n        this.service.getStatesFor(this.currentCountry?.id).pipe(\n          tap(v => console.log(\"combineLatest(states) emitted:\", v)),\n          map(states => states.filter(state => state.description.toLowerCase().includes(userInput.toLowerCase())))\n        )\n      )\n    )\n  }\n\n  countryInputChange(data:any){\n    console.log('in parent for country', data);\n    this.countryControl.next(data.input);\n    this.currentCountry = data.country;\n    this.stateControl.next('');\n  }\n\n  stateInputChange(data:any){\n    console.log('in parent for state', data);\n    if(data && data?.country){\n      this.stateControl.next(data?.stateInput);\n    }\n  }\n\n}\n","<img src=\"assets/exercise5.gif\" />\n\n<div>\n  <h3>Country Dropdown</h3>\n  <app-dropdown \n    [placeholderText]=\"'Country'\"\n    [dropdownData$]=\"countries$\"\n    (countryEmitter)=\"countryInputChange($event)\"\n    />\n</div>\n<div>\n  <h3>States Dropdown</h3>\n  <app-dropdown \n    [placeholderText]=\"'State'\"\n    [dropdownData$]=\"states$\"\n    [currentCountry] = \"currentCountry\"\n    (stateEmitter)=\"stateInputChange($event)\"\n  />\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}