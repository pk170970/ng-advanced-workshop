{"ast":null,"code":"import { combineLatest, Subject } from 'rxjs';\nimport { map, startWith, switchMap, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./country.service\";\nimport * as i2 from \"./dropdown/dropdown.component\";\nexport class Exercise5Component {\n  constructor(service) {\n    this.service = service;\n    this.currentCountry$ = new Subject();\n    this.countryControl = new Subject();\n    this.stateControl = new Subject();\n    this.countries$ = combineLatest([this.countryControl.pipe(startWith('')), this.service.getCountries()]).pipe(map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1)));\n    this.statesForCountry$ = this.currentCountry$.asObservable().pipe(tap(console.log), switchMap(cntry => this.service.getStatesFor(cntry.id)));\n    this.states$ = combineLatest([this.stateControl.pipe(startWith('')), this.statesForCountry$]).pipe(map(([userInput, states]) => states.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1)));\n  }\n  countryInputChange(inputValue) {\n    this.countryControl.next(inputValue);\n  }\n  statesInputChange(data) {\n    console.log(data);\n    if (data && data?.countryId) {\n      this.stateControl.next(data?.stateInput);\n    }\n  }\n}\nExercise5Component.ɵfac = function Exercise5Component_Factory(t) {\n  return new (t || Exercise5Component)(i0.ɵɵdirectiveInject(i1.CountryService));\n};\nExercise5Component.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: Exercise5Component,\n  selectors: [[\"app-exercise5\"]],\n  decls: 9,\n  vars: 3,\n  consts: [[\"src\", \"assets/exercise5.gif\"], [3, \"placeholderText\", \"dropdownData$\", \"countryEmitter\"], [\"placeholderText\", \"State\", 3, \"dropdownData$\", \"stateEmitter\"]],\n  template: function Exercise5Component_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"img\", 0);\n      i0.ɵɵelementStart(1, \"div\")(2, \"h3\");\n      i0.ɵɵtext(3, \"Country Dropdown\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(4, \"app-dropdown\", 1);\n      i0.ɵɵlistener(\"countryEmitter\", function Exercise5Component_Template_app_dropdown_countryEmitter_4_listener($event) {\n        return ctx.countryInputChange($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(5, \"div\")(6, \"h3\");\n      i0.ɵɵtext(7, \"States Dropdown\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"app-dropdown\", 2);\n      i0.ɵɵlistener(\"stateEmitter\", function Exercise5Component_Template_app_dropdown_stateEmitter_8_listener($event) {\n        return ctx.statesInputChange($event);\n      });\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"placeholderText\", \"Country\")(\"dropdownData$\", ctx.countries$);\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"dropdownData$\", ctx.states$);\n    }\n  },\n  dependencies: [i2.DropdownComponent],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AACA,SAAQA,aAAa,EAAkBC,OAAO,QAAO,MAAM;AAI3D,SAAQC,GAAG,EAAEC,SAAS,EAAEC,SAAS,EAAEC,GAAG,QAAO,gBAAgB;;;;AAO7D,OAAM,MAAOC,kBAAkB;EAU7BC,YAAoBC,OAAuB;IAAvB,YAAO,GAAPA,OAAO;IAP3B,oBAAe,GAAG,IAAIP,OAAO,EAAW;IAIxC,mBAAc,GAAG,IAAIA,OAAO,EAAU;IACtC,iBAAY,GAAG,IAAIA,OAAO,EAAU;IAGlC,IAAI,CAACQ,UAAU,GAAGT,aAAa,CAAC,CAC9B,IAAI,CAACU,cAAc,CAACC,IAAI,CAACR,SAAS,CAAC,EAAE,CAAC,CAAC,EACvC,IAAI,CAACK,OAAO,CAACI,YAAY,EAAE,CAC5B,CAAC,CACDD,IAAI,CACHT,GAAG,CAAC,CAAC,CAACW,SAAS,EAAEC,SAAS,CAAC,KAAKA,SAAS,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,OAAO,CAACN,SAAS,CAACK,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC5H;IAGD,IAAI,CAACE,iBAAiB,GAAG,IAAI,CAACC,eAAe,CAACC,YAAY,EAAE,CAACX,IAAI,CAC/DN,GAAG,CAACkB,OAAO,CAACC,GAAG,CAAC,EAChBpB,SAAS,CAACqB,KAAK,IAAI,IAAI,CAACjB,OAAO,CAACkB,YAAY,CAACD,KAAK,CAACE,EAAE,CAAC,CAAC,CACxD;IAGD,IAAI,CAACC,OAAO,GAAG5B,aAAa,CAAC,CAC3B,IAAI,CAAC6B,YAAY,CAAClB,IAAI,CAACR,SAAS,CAAC,EAAE,CAAC,CAAC,EACrC,IAAI,CAACiB,iBAAiB,CACvB,CAAC,CACDT,IAAI,CACHT,GAAG,CAAC,CAAC,CAACW,SAAS,EAAEiB,MAAM,CAAC,KAAKA,MAAM,CAACf,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,OAAO,CAACN,SAAS,CAACK,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CACtH;EACH;EAEAa,kBAAkB,CAACC,UAAiB;IAClC,IAAI,CAACtB,cAAc,CAACuB,IAAI,CAACD,UAAU,CAAC;EACtC;EAEAE,iBAAiB,CAACC,IAAQ;IACxBZ,OAAO,CAACC,GAAG,CAACW,IAAI,CAAC;IACjB,IAAGA,IAAI,IAAIA,IAAI,EAAEC,SAAS,EAAC;MACzB,IAAI,CAACP,YAAY,CAACI,IAAI,CAACE,IAAI,EAAEE,UAAU,CAAC;;EAE5C;;AA5CW/B,kBAAkB;mBAAlBA,kBAAkB;AAAA;AAAlBA,kBAAkB;QAAlBA,kBAAkB;EAAAgC;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCZ/BC,yBAAkC;MAElCA,2BAAK;MACCA,gCAAgB;MAAAA,iBAAK;MACzBA,uCAII;MADFA;QAAA,OAAkBC,8BAA0B;MAAA,EAAC;MAH/CD,iBAII;MAENA,2BAAK;MACCA,+BAAe;MAAAA,iBAAK;MACxBA,uCAIE;MADAA;QAAA,OAAgBC,6BAAyB;MAAA,EAAC;MAH5CD,iBAIE;;;MAXAA,eAA6B;MAA7BA,2CAA6B;MAS7BA,eAAyB;MAAzBA,2CAAyB","names":["combineLatest","Subject","map","startWith","switchMap","tap","Exercise5Component","constructor","service","countries$","countryControl","pipe","getCountries","userInput","countries","filter","c","description","toLowerCase","indexOf","statesForCountry$","currentCountry$","asObservable","console","log","cntry","getStatesFor","id","states$","stateControl","states","countryInputChange","inputValue","next","statesInputChange","data","countryId","stateInput","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["/workspaces/ng-advanced-workshop/src/app/exercise5/exercise5.component.ts","/workspaces/ng-advanced-workshop/src/app/exercise5/exercise5.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport {combineLatest, Observable, of, Subject} from 'rxjs';\nimport {Country, State} from './types';\nimport {FormControl} from '@angular/forms';\nimport {CountryService} from './country.service';\nimport {map, startWith, switchMap, tap} from 'rxjs/operators';\n\n@Component({\n  selector: 'app-exercise5',\n  templateUrl: './exercise5.component.html',\n  styleUrls: ['./exercise5.component.css']\n})\nexport class Exercise5Component {\n\n  countries$: Observable<Country[]>;\n  currentCountry$ = new Subject<Country>();\n  states$: Observable<State[]>;\n  \n  state: State;\n  countryControl = new Subject<string>();\n  stateControl = new Subject<string>();\n\n  constructor(private service: CountryService) {\n    this.countries$ = combineLatest([\n      this.countryControl.pipe(startWith('')),\n      this.service.getCountries()\n    ])\n    .pipe(\n      map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1))\n    );\n\n\n    this.statesForCountry$ = this.currentCountry$.asObservable().pipe(\n      tap(console.log),\n      switchMap(cntry => this.service.getStatesFor(cntry.id))\n    );\n\n\n    this.states$ = combineLatest([\n      this.stateControl.pipe(startWith('')),\n      this.statesForCountry$\n    ])\n    .pipe(\n      map(([userInput, states]) => states.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1))\n    );\n  }\n\n  countryInputChange(inputValue:string){\n    this.countryControl.next(inputValue);\n  }\n\n  statesInputChange(data:any){\n    console.log(data);\n    if(data && data?.countryId){\n      this.stateControl.next(data?.stateInput);\n    }\n  }\n\n}\n","<img src=\"assets/exercise5.gif\" />\n\n<div>\n  <h3>Country Dropdown</h3>\n  <app-dropdown \n    [placeholderText]=\"'Country'\"\n    [dropdownData$]=\"countries$\"\n    (countryEmitter)=\"countryInputChange($event)\"\n    />\n</div>\n<div>\n  <h3>States Dropdown</h3>\n  <app-dropdown \n    placeholderText=\"State\"\n    [dropdownData$]=\"states$\"\n    (stateEmitter)=\"statesInputChange($event)\"\n  />\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}