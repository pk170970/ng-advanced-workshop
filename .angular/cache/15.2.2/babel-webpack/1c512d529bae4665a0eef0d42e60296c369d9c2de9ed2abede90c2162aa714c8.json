{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { combineLatest, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../country.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"../../solution/solution3/highlight.pipe\";\nfunction DropdownComponent_div_2_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"span\", 5);\n    i0.ɵɵlistener(\"click\", function DropdownComponent_div_2_span_1_Template_span_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const data_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r4.updateStates(data_r3));\n    });\n    i0.ɵɵpipe(1, \"highlight\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const data_r3 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"innerHTML\", i0.ɵɵpipeBind2(1, 1, data_r3.description, ctx_r2.dropdownControl.value), i0.ɵɵsanitizeHtml);\n  }\n}\nfunction DropdownComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵtemplate(1, DropdownComponent_div_2_span_1_Template, 2, 4, \"span\", 4);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const dropdownData_r1 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", dropdownData_r1);\n  }\n}\nexport class DropdownComponent {\n  constructor(service) {\n    this.service = service;\n    this.placeholderText = '';\n    this.currentCountry$ = new Subject();\n    this.statesForCountry$ = of([]);\n    this.countryControl = new FormControl('');\n    this.stateControl = new FormControl('');\n    this.dropdownControl = new FormControl('');\n  }\n  ngOnInit() {\n    if (this.placeholderText === \"Country\") {\n      this.dropdownData$ = combineLatest([this.dropdownControl.valueChanges, this.service.getCountries()]).pipe(map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1)));\n    } else if (this.placeholderText === \"State\") {\n      this.statesForCountry$ = this.currentCountry$.asObservable().pipe(tap(console.log), switchMap(cntry => this.service.getStatesFor(cntry.id)));\n      this.states$ = combineLatest([this.stateControl.valueChanges, this.statesForCountry$]).pipe(map(([userInput, states]) => states.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1)));\n    }\n    // this.dropdownControl.valueChanges.subscribe(data =>{\n    //   console.log('data', data);\n    //   if(this.placeholderText === 'Country'){\n    //     this.countryControl.emit()\n    //   }\n    // });\n  }\n\n  updateStates(country) {\n    // this.countryControl.setValue(country.description);\n    // this.stateControl.setValue('');\n    // this.currentCountry$.next(country);\n  }\n}\nDropdownComponent.ɵfac = function DropdownComponent_Factory(t) {\n  return new (t || DropdownComponent)(i0.ɵɵdirectiveInject(i1.CountryService));\n};\nDropdownComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: DropdownComponent,\n  selectors: [[\"app-dropdown\"]],\n  inputs: {\n    placeholderText: \"placeholderText\"\n  },\n  decls: 4,\n  vars: 5,\n  consts: [[1, \"dropdown\"], [\"type\", \"text\", 1, \"dropbtn\", 3, \"formControl\", \"placeholder\"], [\"class\", \"dropdown-content\", 4, \"ngIf\"], [1, \"dropdown-content\"], [3, \"innerHTML\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"innerHTML\", \"click\"]],\n  template: function DropdownComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"input\", 1);\n      i0.ɵɵtemplate(2, DropdownComponent_div_2_Template, 2, 1, \"div\", 2);\n      i0.ɵɵpipe(3, \"async\");\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formControl\", ctx.dropdownControl)(\"placeholder\", \"Enter \" + ctx.placeholderText + \" name\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(3, 3, ctx.dropdownData$));\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.FormControlDirective, i2.AsyncPipe, i4.HighlightPipe],\n  styles: [\".dropbtn[_ngcontent-%COMP%] {\\n  padding: 5px;\\n  font-size: 16px;\\n}\\n\\n.dropdown[_ngcontent-%COMP%] {\\n  position: relative;\\n  display: inline-block;\\n}\\n\\n.dropdown-content[_ngcontent-%COMP%] {\\n  display: none;\\n  position: absolute;\\n  min-width: 160px;\\n  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);\\n  z-index: 1;\\n}\\n\\n.dropdown-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n  color: black;\\n  padding: 12px 16px;\\n  text-decoration: none;\\n  display: block;\\n  background-color: white;\\n}\\n\\n.dropdown-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover {background-color: #f1f1f1}\\n\\n.dropdown[_ngcontent-%COMP%]:hover   .dropdown-content[_ngcontent-%COMP%], .dropbtn[_ngcontent-%COMP%]:focus    + .dropdown-content[_ngcontent-%COMP%]{\\n  display: block;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZXhlcmNpc2U1L2Ryb3Bkb3duL2Ryb3Bkb3duLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxZQUFZO0VBQ1osZUFBZTtBQUNqQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQixxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxhQUFhO0VBQ2Isa0JBQWtCO0VBQ2xCLGdCQUFnQjtFQUNoQiw0Q0FBNEM7RUFDNUMsVUFBVTtBQUNaOztBQUVBO0VBQ0UsWUFBWTtFQUNaLGtCQUFrQjtFQUNsQixxQkFBcUI7RUFDckIsY0FBYztFQUNkLHVCQUF1QjtBQUN6Qjs7QUFFQSw4QkFBOEIseUJBQXlCOztBQUV2RDtFQUNFLGNBQWM7QUFDaEIiLCJzb3VyY2VzQ29udGVudCI6WyIuZHJvcGJ0biB7XG4gIHBhZGRpbmc6IDVweDtcbiAgZm9udC1zaXplOiAxNnB4O1xufVxuXG4uZHJvcGRvd24ge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbn1cblxuLmRyb3Bkb3duLWNvbnRlbnQge1xuICBkaXNwbGF5OiBub25lO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIG1pbi13aWR0aDogMTYwcHg7XG4gIGJveC1zaGFkb3c6IDBweCA4cHggMTZweCAwcHggcmdiYSgwLDAsMCwwLjIpO1xuICB6LWluZGV4OiAxO1xufVxuXG4uZHJvcGRvd24tY29udGVudCBzcGFuIHtcbiAgY29sb3I6IGJsYWNrO1xuICBwYWRkaW5nOiAxMnB4IDE2cHg7XG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbiAgZGlzcGxheTogYmxvY2s7XG4gIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xufVxuXG4uZHJvcGRvd24tY29udGVudCBzcGFuOmhvdmVyIHtiYWNrZ3JvdW5kLWNvbG9yOiAjZjFmMWYxfVxuXG4uZHJvcGRvd246aG92ZXIgLmRyb3Bkb3duLWNvbnRlbnQsIC5kcm9wYnRuOmZvY3VzICsgLmRyb3Bkb3duLWNvbnRlbnR7XG4gIGRpc3BsYXk6IGJsb2NrO1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AACA,SAASA,WAAW,QAAQ,gBAAgB;AAC5C,SAASC,aAAa,EAAEC,GAAG,QAAoB,MAAM;;;;;;;;;ICE/CC,+BACwE;IADhCA;MAAA;MAAA;MAAA;MAAA,OAASA,2CAAkB;IAAA,EAAC;;IAEpEA,iBAAO;;;;;IADDA,sHAAiE;;;;;IAFzEA,8BAA4E;IAC1EA,0EAEO;IACTA,iBAAM;;;;IAHmBA,eAAe;IAAfA,yCAAe;;;ADO5C,OAAM,MAAOC,iBAAiB;EAa5BC,YAAoBC,OAAuB;IAAvB,YAAO,GAAPA,OAAO;IAXD,oBAAe,GAAW,EAAE;IAEtD,oBAAe,GAAG,IAAIC,OAAO,EAAW;IAExC,sBAAiB,GAAyBC,EAAE,CAAC,EAAE,CAAC;IAEhD,mBAAc,GAAG,IAAIR,WAAW,CAAC,EAAE,CAAC;IACpC,iBAAY,GAAG,IAAIA,WAAW,CAAC,EAAE,CAAC;IAElC,oBAAe,GAAG,IAAIA,WAAW,CAAS,EAAE,CAAC;EAG7C;EAEAS,QAAQ;IACN,IAAI,IAAI,CAACC,eAAe,KAAK,SAAS,EAAE;MACtC,IAAI,CAACC,aAAa,GAAGV,aAAa,CAAC,CAAC,IAAI,CAACW,eAAe,CAACC,YAAY,EAAE,IAAI,CAACP,OAAO,CAACQ,YAAY,EAAE,CAAC,CAAC,CAACC,IAAI,CACvGb,GAAG,CAAC,CAAC,CAACc,SAAS,EAAEC,SAAS,CAAC,KAAKA,SAAS,CAACC,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,OAAO,CAACN,SAAS,CAACK,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC5H;KACF,MAAK,IAAG,IAAI,CAACX,eAAe,KAAK,OAAO,EAAC;MACxC,IAAI,CAACa,iBAAiB,GAAG,IAAI,CAACC,eAAe,CAACC,YAAY,EAAE,CAACV,IAAI,CAC3DW,GAAG,CAACC,OAAO,CAACC,GAAG,CAAC,EAChBC,SAAS,CAACC,KAAK,IAAI,IAAI,CAACxB,OAAO,CAACyB,YAAY,CAACD,KAAK,CAACE,EAAE,CAAC,CAAC,CACxD;MACD,IAAI,CAACC,OAAO,GAAGhC,aAAa,CAAC,CAAC,IAAI,CAACiC,YAAY,CAACrB,YAAY,EAAE,IAAI,CAACU,iBAAiB,CAAC,CAAC,CAACR,IAAI,CACzFb,GAAG,CAAC,CAAC,CAACc,SAAS,EAAEmB,MAAM,CAAC,KAAKA,MAAM,CAACjB,MAAM,CAACC,CAAC,IAAIA,CAAC,CAACC,WAAW,CAACC,WAAW,EAAE,CAACC,OAAO,CAACN,SAAS,CAACK,WAAW,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CACtH;;IAKP;IACA;IACA;IACA;IACA;IACA;EACF;;EAEAe,YAAY,CAACC,OAAgB;IAC3B;IACA;IACA;EAAA;;AA5CSjC,iBAAiB;mBAAjBA,iBAAiB;AAAA;AAAjBA,iBAAiB;QAAjBA,iBAAiB;EAAAkC;EAAAC;IAAA7B;EAAA;EAAA8B;EAAAC;EAAAC;EAAAC;IAAA;MCX9BxC,8BAAsB;MAClBA,2BAC6D;MAC7DA,kEAIM;;MACVA,iBAAM;;;MAPiCA,eAA+B;MAA/BA,iDAA+B;MAEnCA,eAA4B;MAA5BA,8DAA4B","names":["FormControl","combineLatest","map","i0","DropdownComponent","constructor","service","Subject","of","ngOnInit","placeholderText","dropdownData$","dropdownControl","valueChanges","getCountries","pipe","userInput","countries","filter","c","description","toLowerCase","indexOf","statesForCountry$","currentCountry$","asObservable","tap","console","log","switchMap","cntry","getStatesFor","id","states$","stateControl","states","updateStates","country","selectors","inputs","decls","vars","consts","template"],"sourceRoot":"","sources":["/workspaces/ng-advanced-workshop/src/app/exercise5/dropdown/dropdown.component.ts","/workspaces/ng-advanced-workshop/src/app/exercise5/dropdown/dropdown.component.html"],"sourcesContent":["import { Component, EventEmitter, Input, Output, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { combineLatest, map, Observable } from 'rxjs';\nimport { Country, State } from '../types';\nimport { CountryService } from '../country.service';\n\n@Component({\n  selector: 'app-dropdown',\n  templateUrl: './dropdown.component.html',\n  styleUrls: ['./dropdown.component.css']\n})\nexport class DropdownComponent implements OnInit {\n\n  @Input('placeholderText') placeholderText: string = '';\n  countries$: Observable<Country[]>;\n  currentCountry$ = new Subject<Country>();\n  states$: Observable<State[]>;\n  statesForCountry$: Observable<State[]> =  of([]);\n  state: State;\n  countryControl = new FormControl('');\n  stateControl = new FormControl('');\n\n  dropdownControl = new FormControl<string>('');\n\n  constructor(private service: CountryService) {\n  }\n\n  ngOnInit(): void {\n    if (this.placeholderText === \"Country\") {\n      this.dropdownData$ = combineLatest([this.dropdownControl.valueChanges, this.service.getCountries()]).pipe(\n        map(([userInput, countries]) => countries.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1))\n      );\n    }else if(this.placeholderText === \"State\"){\n      this.statesForCountry$ = this.currentCountry$.asObservable().pipe(\n            tap(console.log),\n            switchMap(cntry => this.service.getStatesFor(cntry.id))\n          );\n          this.states$ = combineLatest([this.stateControl.valueChanges, this.statesForCountry$]).pipe(\n            map(([userInput, states]) => states.filter(c => c.description.toLowerCase().indexOf(userInput.toLowerCase()) !== -1))\n          );\n    }\n\n\n\n    // this.dropdownControl.valueChanges.subscribe(data =>{\n    //   console.log('data', data);\n    //   if(this.placeholderText === 'Country'){\n    //     this.countryControl.emit()\n    //   }\n    // });\n  }\n\n  updateStates(country: Country) {\n    // this.countryControl.setValue(country.description);\n    // this.stateControl.setValue('');\n    // this.currentCountry$.next(country);\n  }\n\n}\n","<div class=\"dropdown\">\n    <input type=\"text\" class=\"dropbtn\" [formControl]=\"dropdownControl\"\n           [placeholder]=\"'Enter ' + placeholderText + ' name'\" >\n    <div class=\"dropdown-content\" *ngIf=\"dropdownData$ | async as dropdownData\">\n      <span *ngFor=\"let data of dropdownData\" (click)=\"updateStates(data)\"\n            [innerHTML]=\"data.description | highlight: dropdownControl.value\">\n      </span>\n    </div>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}